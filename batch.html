<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸŽ® Batch Game Card Generator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #eee;
    padding: 20px;
  }

  h1, h2 {
    margin-bottom: 10px;
  }

  label {
    display: block;
    margin-top: 10px;
  }

  input, select, button, textarea {
    margin-top: 5px;
    padding: 6px 10px;
    background: #222;
    border: 1px solid #444;
    color: #eee;
    border-radius: 8px;   /* consistent rounded corners */
    box-sizing: border-box;
  }

  input, select {
    height: 35px;
  }

  textarea {
    width: 100%;
    height: 250px;
    font-family: monospace;
    border-radius: 8px;
    margin-top: 15px;
  }

  #fileList {
    margin-top: 20px;
  }

  .file-entry {
    display: flex;
    align-items: center;
    gap: 6px;
    margin: 5px 0;
  }

  .file-entry img {
    height: 40px;
    width: auto;
    background: #222;
    border: 1px solid #444;
  }

  .file-entry input {
    flex: 1;
  }

  /* Status buttons */
  .status-btn {
    width: 16px;
    height: 16px;
    margin-left: 6px;
    border-radius: 4px;
    border: 2px solid #444;
    cursor: pointer;
    flex-shrink: 0;
  }
  .ok { background: #7CFC00; }   /* light green */
  .FIX { background: #FFD700; }  /* golden yellow */
  .soon { background: #FF6F61; } /* pinkish red */

  /* Remove button (X) */
  .file-entry button {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    border: 1px solid #444;
    background: #333;
    color: #eee;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 14px;
    flex-shrink: 0;
  }

  /* Generate button */
  .generateBtn {
    display: block;
    margin: 20px 0 10px 0;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    background: #222;
    border: 1px solid #444;
    color: #eee;
    width: fit-content;
  }
</style>
</head>
<body>
<h1>ðŸŽ® Batch Game Card Generator</h1>

<!-- GitHub config -->
<label>GitHub Username:</label>
<input type="text" id="githubUser" placeholder="e.g. bguhm">

<label>Repository Name:</label>
<input type="text" id="repoName" placeholder="e.g. bguhm.github.io">

<label>Image Folder Path:</label>
<input type="text" id="folderPath" placeholder="e.g. library/images/">

<!-- Upload + defaults -->
<label>Upload Images:</label>
<input type="file" id="imageUpload" multiple accept="image/*">

<label>Default Developer / Description:</label>
<input type="text" id="defaultDev" placeholder="Made by ...">

<label>Default Status:</label>
<select id="defaultStatus">
  <option value="ok">ok</option>
  <option value="FIX">FIX</option>
  <option value="soon">soon</option>
</select>

<!-- File list -->
<div id="fileList"></div>

<!-- Generate -->
<button class="generateBtn" onclick="generateAll()">Generate All Divs</button>

<h2>Generated Code:</h2>
<textarea id="output" readonly></textarea>

<script>
let files = [];

document.getElementById('imageUpload').addEventListener('change', (event) => {
  files = Array.from(event.target.files);
  displayFiles();
});

function displayFiles() {
  const fileList = document.getElementById('fileList');
  fileList.innerHTML = '';

  files.forEach((file, index) => {
    const div = document.createElement('div');
    div.classList.add('file-entry');

    // Status button
    const statusBtn = document.createElement('div');
    let status = document.getElementById('defaultStatus').value;
    statusBtn.classList.add('status-btn', status);
    statusBtn.onclick = () => {
      if (status === "ok") status = "FIX";
      else if (status === "FIX") status = "soon";
      else status = "ok";
      statusBtn.className = "status-btn " + status;
    };

    // Image preview
    const img = document.createElement('img');
    img.src = URL.createObjectURL(file);
    img.dataset.filename = file.name; // keep original name for GitHub URL

    // URL field
    const urlInput = document.createElement('input');
    urlInput.type = 'text';
    urlInput.placeholder = 'Game link URL';

    // Title field
    const titleInput = document.createElement('input');
    titleInput.type = 'text';
    titleInput.value = file.name.replace(/\.[^/.]+$/, "");

    // Description / credits field
    const descInput = document.createElement('input');
    descInput.type = 'text';
    descInput.placeholder = 'Description / Credits (optional)';

    // Remove button
    const removeBtn = document.createElement('button');
    removeBtn.textContent = "X";
    removeBtn.onclick = () => {
      files.splice(index, 1);
      displayFiles();
    };

    div.appendChild(statusBtn);
    div.appendChild(img);
    div.appendChild(urlInput);
    div.appendChild(titleInput);
    div.appendChild(descInput);
    div.appendChild(removeBtn);

    fileList.appendChild(div);
  });
}

function generateAll() {
  let output = '';

  const githubUser = document.getElementById('githubUser').value.trim();
  const repoName = document.getElementById('repoName').value.trim();
  const folderPath = document.getElementById('folderPath').value.trim();

  document.querySelectorAll('.file-entry').forEach(div => {
    const img = div.querySelector('img');
    const urlInput = div.querySelectorAll('input')[0];
    const titleInput = div.querySelectorAll('input')[1];
    const descInput = div.querySelectorAll('input')[2];
    const statusBtn = div.querySelector('.status-btn');
    const status = statusBtn.classList[1] || "ok";

    const fileName = img.dataset.filename;
    const rawURL = (githubUser && repoName && folderPath && fileName)
      ? `https://raw.githubusercontent.com/${githubUser}/${repoName}/main/${folderPath}${fileName}`
      : img.src;

    const gameTitle = titleInput.value || fileName.replace(/\.[^/.]+$/, "");
    const gameURL = urlInput.value || "#";
    const gameDesc = descInput.value || document.getElementById('defaultDev').value || '';

    const divBlock = `
<div class="${status}">
  <a href="${gameURL}">
    <img src="${rawURL}" onerror="this.src='replace.png';"/>
    <h3>${gameTitle}</h3>
    ${gameDesc ? `<p>${gameDesc}</p>` : ''}
  </a>
</div>`;
    output += divBlock + "\n\n";
  });

  document.getElementById('output').value = output;
}
</script>
</body>
</html>
